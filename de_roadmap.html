<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Roadmap (hidden title)</title>
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --fg: #e6e6e6;
      --glass: rgba(255,255,255,0.08);
      --glass-strong: rgba(255,255,255,0.12);
      --accent: rgba(114,137,218,0.95);
    }

    /* Page reset */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: "Josefin Sans", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--fg);
      background: url('background.jpg') center/cover no-repeat fixed;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Blurry overlay to dim background */
    .bg-overlay{
      position:fixed;
      inset:0;
      background: rgba(6,6,6,0.45);
      backdrop-filter: blur(14px) saturate(110%);
      z-index:0;
    }

    /* Page container */
    .wrap{
      position:relative;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 24px;
      z-index:1;
    }

    /* Small back button */
    .back {
      position: fixed;
      left: 18px;
      top: 18px;
      z-index: 15;
      background: var(--glass-strong);
      border-radius: 10px;
      padding: 8px 10px;
      display: inline-flex;
      gap: 8px;
      align-items:center;
      cursor:pointer;
      text-decoration:none;
      color:var(--fg);
      box-shadow: 0 6px 18px rgba(0,0,0,0.45);
      backdrop-filter: blur(8px);
      transition: transform .15s ease, background .15s ease;
    }
    .back:hover{ transform: translateY(-3px); background: rgba(255,255,255,0.14) }
    .back svg{ width:18px; height:18px; display:block; }

    /* Loading indicator */
    .loading {
      text-align: center;
      font-size: 14px;
      opacity: 0.8;
      padding: 40px;
    }

    /* Error message */
    .error {
      text-align: center;
      color: #ff6b6b;
      font-size: 14px;
      padding: 40px;
      background: rgba(255, 107, 107, 0.1);
      border-radius: 12px;
      border: 1px solid rgba(255, 107, 107, 0.2);
    }

    /* Roadmap card */
    .roadmap-card{
      width:100%;
      max-width:1100px;
      border-radius:18px;
      padding:28px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      box-shadow: 0 10px 40px rgba(0,0,0,0.55);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.04);
    }

    /* Intro row */
    .intro{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:16px;
      margin-bottom:20px;
    }
    .intro .hint{
      font-size:13px;
      opacity:.9;
      color:var(--fg);
    }

    /* Timeline container */
    .timeline{
      display:grid;
      gap:18px;
    }

    /* Horizontal row of capsules on wide screens: 4 columns */
    .milestones{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:16px;
      align-items:start;
    }

    /* Single milestone capsule */
    .milestone{
      background: var(--glass);
      border-radius: 14px;
      padding:18px;
      text-align:center;
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
      border:1px solid rgba(255,255,255,0.03);
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:150px;
      justify-content:flex-start;
      align-items:center;
      position:relative;
    }
    .milestone:hover{
      transform: translateY(-6px);
      background: rgba(255,255,255,0.12);
      box-shadow: 0 18px 40px rgba(8,8,8,0.6);
    }

    .milestone .logo{
      width:72px;
      height:72px;
      border-radius:12px;
      display:inline-grid;
      place-items:center;
      background:rgba(0,0,0,0.25);
      overflow:hidden;
      flex-shrink:0;
    }
    .milestone .logo img{ width:100%; height:100%; object-fit:contain; display:block }

    .milestone .title{
      font-weight:700;
      font-size:15px;
      letter-spacing:0.2px;
    }
    .milestone .when{
      font-size:12px;
      opacity:0.85;
    }
    .milestone .desc{
      font-size:13px;
      opacity:0.92;
      line-height:1.3;
      margin-top:6px;
    }

    /* Status badges */
    .badge{
      position:absolute;
      right:12px;
      top:12px;
      font-size:11px;
      padding:6px 8px;
      border-radius:999px;
      color:white;
      box-shadow:0 6px 18px rgba(16,12,44,0.45);
    }
    .badge.finished{ background: var(--accent); }
    .badge.wip{ background: #58c79a; }
    .badge.planned{ background: #ffa726; }
    .badge.funding{ background: #ff5100; }

    /* Modal for expanded milestone */
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 25;
      padding: 20px;
    }
    .modal.open { display:flex; }
    .modal-inner{
      width:100%;
      max-width:820px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:14px;
      padding:22px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      border:1px solid rgba(255,255,255,0.04);
      backdrop-filter: blur(10px);
      color:var(--fg);
    }
    .modal-close{
      float:right;
      background:transparent;
      border:none;
      color:var(--fg);
      font-size:18px;
      cursor:pointer;
    }

    /* Responsive */
    @media (max-width:980px){
      .milestones{ grid-template-columns: repeat(2, 1fr) }
    }
    @media (max-width:560px){
      .milestones{ grid-template-columns: 1fr }
      .roadmap-card{ padding:18px }
      .milestone{ min-height:130px; padding:14px }
      .milestone .logo{ width:56px; height:56px }
    }

  </style>
</head>
<body>

  <div class="bg-overlay" aria-hidden="true"></div>

  <!-- small back button -->
  <a class="back" href="index.html" aria-label="Back to main page">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M15 18l-6-6 6-6"></path>
    </svg>
    <span style="font-size:13px">Back</span>
  </a>

  <main class="wrap" role="main">
    <section class="roadmap-card" aria-label="Roadmap">
      <div class="intro">
        <div class="hint">Project roadmap â€” click any milestone for details</div>
        <div style="font-size:12px;opacity:.85"> </div>
      </div>

      <div class="timeline">
        <div id="milestones-container" class="milestones">
          <div class="loading">Loading roadmap...</div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal for milestone details -->
  <div id="modal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal-inner" role="document">
      <button class="modal-close" aria-label="Close details">&times;</button>
      <div id="modal-content">
        <!-- Filled dynamically -->
      </div>
    </div>
  </div>

  <script>
    let milestoneData = {};
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modal-content');
    const closeBtn = document.querySelector('.modal-close');
    const milestonesContainer = document.getElementById('milestones-container');

    // Function to determine badge class and text based on status
    function getBadgeInfo(status) {
      const statusLower = status.toLowerCase();
      if (statusLower === 'finished') {
        return { class: 'finished', text: 'Finished' };
      } else if (statusLower === 'wip' || statusLower.includes('wip')) {
        return { class: 'wip', text: 'Beta' };
      } else if (statusLower === 'planned' || statusLower.includes('planned')) {
        return { class: 'planned', text: 'Planned' };
        } else if (statusLower.includes('funding')) {
        return { class: 'funding', text: 'Need Funding' };
      }
    }

    // Function to parse roadmap data from text
    function parseRoadmapData(text) {
      const lines = text.trim().split('\n');
      const milestones = [];
      
      lines.forEach((line, index) => {
        if (line.trim()) {
          const parts = line.split('|');
          if (parts.length >= 5) {
            const id = `m${index + 1}`;
            const milestone = {
              id: id,
              icon: parts[0].trim(),
              title: parts[1].trim(),
              status: parts[2].trim(),
              shortDesc: parts[3].trim(),
              longDesc: parts[4].trim()
            };
            milestones.push(milestone);
            milestoneData[id] = {
              title: milestone.title,
              when: milestone.status,
              details: milestone.longDesc
            };
          }
        }
      });
      
      return milestones;
    }

    // Function to render milestones
    function renderMilestones(milestones) {
      const html = milestones.map(milestone => {
        const badgeInfo = getBadgeInfo(milestone.status);
        return `
          <article class="milestone" data-id="${milestone.id}" tabindex="0" role="button" aria-pressed="false">
            <div class="logo"><img src="${milestone.icon}" alt="${milestone.title} logo"></div>
            <div class="title">${milestone.title}</div>
            <div class="when">${milestone.status}</div>
            <div class="desc">${milestone.shortDesc}</div>
            <div class="badge ${badgeInfo.class}">${badgeInfo.text}</div>
          </article>
        `;
      }).join('');
      
      milestonesContainer.innerHTML = html;
      
      // Wire up event listeners for the new elements
      setupEventListeners();
    }

    // Function to show error message
    function showError(message) {
      milestonesContainer.innerHTML = `<div class="error">${message}</div>`;
    }

    // Function to load roadmap data from file
    async function loadRoadmapData() {
      try {
        const response = await fetch('roadmap_data.txt');
        if (!response.ok) {
          throw new Error(`Failed to load roadmap data: ${response.status} ${response.statusText}`);
        }
        
        const text = await response.text();
        const milestones = parseRoadmapData(text);
        
        if (milestones.length === 0) {
          throw new Error('No valid milestone data found in file');
        }
        
        renderMilestones(milestones);
      } catch (error) {
        console.error('Error loading roadmap data:', error);
        showError(`Error loading roadmap: ${error.message}<br><br>Make sure 'roadmap_data.txt' exists and is properly formatted.`);
      }
    }

    // Modal functions
    function openModal(id) {
      const data = milestoneData[id];
      if (!data) return;
      modalContent.innerHTML = `
        <h3 style="margin-top:2px;margin-bottom:8px;font-size:20px">${data.title}</h3>
        <div style="font-size:13px;opacity:.9;margin-bottom:12px">${data.when}</div>
        <div style="font-size:14px;line-height:1.5">${data.details}</div>
      `;
      modal.classList.add('open');
      modal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    }

    // Setup event listeners for milestones
    function setupEventListeners() {
      document.querySelectorAll('.milestone').forEach(el => {
        el.addEventListener('click', () => openModal(el.dataset.id));
        el.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            openModal(el.dataset.id);
          }
        });
      });
    }

    // Setup modal event listeners
    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    // Load roadmap data on page load
    document.addEventListener('DOMContentLoaded', loadRoadmapData);
  </script>
</body>
</html>